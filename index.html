    <script>
        async function downloadVideo() {
            const url = document.getElementById('videoUrl').value;
            const resDiv = document.getElementById('result');
            if(!url) return alert("ضع الرابط أولاً");
            
            resDiv.innerHTML = "جاري التحضير...";
            try {
                const response = await fetch(`https://www.tikwm.com/api/?url=${encodeURIComponent(url)}`);
                const data = await response.json();
                
                if(data.data && data.data.play) {
                    // التعديل هنا لضمان أن الرابط يبدأ بـ https بشكل صحيح
                    const videoLink = data.data.play.startsWith('http') ? data.data.play : `https://www.tikwm.com${data.data.play}`;
                    
                    resDiv.innerHTML = `
                        <p style="color: #25d366; font-weight: bold;">تم استخراج الفيديو بنجاح!</p>
                        <a href="${videoLink}" target="_blank" class="btn-download">تحميل الفيديو الآن</a>
                    `;
                } else {
                    resDiv.innerHTML = "تعذر التحميل، تأكد من أن الحساب ليس خاصاً.";
                }
            } catch (e) {
                resDiv.innerHTML = "خطأ في الاتصال، حاول مرة أخرى.";
            }
        }
    </script>
